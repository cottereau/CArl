clear all;
close all;

X = [-2.5000   -0.5000
   -2.5000    0.5000
   -1.5000   -0.5000
   -1.5000    0.5000
   -0.5000   -0.5000
   -0.5000    0.5000
    0.5000   -0.5000
    0.5000    0.5000
    1.5000   -0.5000
    1.5000    0.5000
    2.5000   -0.5000
    2.5000    0.5000] ;

T = [1     3     2
     2     3     4
     3     5     4
     4     5     6
     5     7     6
     6     7     8
     7     9     8
     8     9    10
     9    11    10
    10    11    12] ;

n=find(X(:,1)>-2.5) ;
m=[11;12];

Lg =  [0 0 0 0 0 0 0 0 0 0 1 0        
       0 0 0 0 0 0 0 0 0 0 0 1         
       1 0 0 0 0 0 0 0 0 0 0 0         
       0 1 0 0 0 0 0 0 0 0 0 0];

[Nn d]= size(X) ;
[Ne nnode] = size(T) ;

E = ones(Nn,1) ;

Fi = spalloc(Nn+4,1,0) ;
Fi([13;14],1) = 0.05 ;

sol = zeros(Nn,1) ;

[Ki,B,b]=genmat2(X,T,E,zeros(Nn,1),zeros(Nn,1));

K = [Ki,Lg';Lg,zeros(4)] ;
soli = K \ Fi ;

sol = soli(1:Nn,1) ;

figure
trisurf( T, X(:,1), X(:,2), sol) ;
figure
trisurf( T, X(:,1), X(:,2), E ) ;