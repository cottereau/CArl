#!/bin/bash

#PBS -S /bin/bash
#PBS -N test_ae_1k
#PBS -o assemb.o
#PBS -e assemb.e
#PBS -l walltime=3:59:00
#PBS -l select=1:ncpus=4:mpiprocs=4

# "fusion" PBS options
#PBS -q defaultq
#PBS -P omaha

# Chargement des modules
# "fusion" cluster modules
module purge
module load intel-compilers/17.0.4
module load intel-mpi/2017.0.3

# On se place dans le repertoire depuis lequel le job a ete soumis
export PETSC_DIR="/home/gattif/srclib/petsc"
export PETSC_ARCH="arch-linux2-cxx-opt"
export CGAL_DIR="/home/gattif/LOCAL/cgal"
export LIBMESH_DIR="/home/gattif/LOCAL/libmesh"
export BOOST_ROOT="home/gattif/LOCAL/boost"

cd $PBS_O_WORKDIR

mkdir -p examples/coupled_traction_test/FETI_solver/brick_traction_1k_dyn/system_matrices_dyn

echo " --- Assemble clamped coupled model ..."
mpirun -np 4 ./libmesh_assemble_lin_homogeneous__min_x_clamped_dyn -i examples/coupled_traction_test/FETI_solver/brick_traction_1k_dyn/assemble_brick_traction_A_1k_dyn.txt 

#echo " --- Assemble traction coupled model ..."
#mpirun -np 4 ./libmesh_assemble_lin_homogeneous__max_x_traction_dyn -i examples/coupled_traction_test/FETI_solver/brick_traction_1k_dyn/assemble_brick_traction_B_1k_dyn.txt
#
