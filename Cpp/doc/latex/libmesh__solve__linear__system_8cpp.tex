\hypertarget{libmesh__solve__linear__system_8cpp}{}\section{/\+Users/breubreubreu/\+Programming/\+C\+Arl/\+Cpp/src/execs/ext\+\_\+solver\+\_\+libmesh/libmesh\+\_\+solve\+\_\+linear\+\_\+system.cpp File Reference}
\label{libmesh__solve__linear__system_8cpp}\index{/\+Users/breubreubreu/\+Programming/\+C\+Arl/\+Cpp/src/execs/ext\+\_\+solver\+\_\+libmesh/libmesh\+\_\+solve\+\_\+linear\+\_\+system.\+cpp@{/\+Users/breubreubreu/\+Programming/\+C\+Arl/\+Cpp/src/execs/ext\+\_\+solver\+\_\+libmesh/libmesh\+\_\+solve\+\_\+linear\+\_\+system.\+cpp}}
{\ttfamily \#include \char`\"{}libmesh\+\_\+solve\+\_\+linear\+\_\+system.\+h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{libmesh__solve__linear__system_8cpp_a3c04138a5bfe5d72780bb7e82a18e627}{main} (int argc, char $\ast$$\ast$argv)
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{libmesh__solve__linear__system_8cpp_a3c04138a5bfe5d72780bb7e82a18e627}{}\index{libmesh\+\_\+solve\+\_\+linear\+\_\+system.\+cpp@{libmesh\+\_\+solve\+\_\+linear\+\_\+system.\+cpp}!main@{main}}
\index{main@{main}!libmesh\+\_\+solve\+\_\+linear\+\_\+system.\+cpp@{libmesh\+\_\+solve\+\_\+linear\+\_\+system.\+cpp}}
\subsubsection[{main(int argc, char $\ast$$\ast$argv)}]{\setlength{\rightskip}{0pt plus 5cm}int main (
\begin{DoxyParamCaption}
\item[{int}]{argc, }
\item[{char $\ast$$\ast$}]{argv}
\end{DoxyParamCaption}
)}\label{libmesh__solve__linear__system_8cpp_a3c04138a5bfe5d72780bb7e82a18e627}


Definition at line 3 of file libmesh\+\_\+solve\+\_\+linear\+\_\+system.\+cpp.


\begin{DoxyCode}
3                                 \{
4 
5     \textcolor{comment}{// --- Initialize libMesh}
6     libMesh::LibMeshInit init(argc, argv);
7 
8     \textcolor{comment}{// Do performance log?}
9     libMesh::PerfLog perf\_log(\textcolor{stringliteral}{"Main program"});
10 
11     \textcolor{comment}{// libMesh's C++ / MPI communicator wrapper}
12     libMesh::Parallel::Communicator& WorldComm = init.comm();
13 
14     \textcolor{comment}{// Number of processors and processor rank.}
15     \textcolor{keywordtype}{int} rank = WorldComm.rank();
16     \textcolor{keywordtype}{int} nodes = WorldComm.size();
17 
18     \textcolor{comment}{// --- Set up inputs}
19 
20     \textcolor{comment}{// Command line parser}
21     GetPot command\_line(argc, argv);
22 
23     \textcolor{comment}{// File parser}
24     GetPot field\_parser;
25 
26     \textcolor{comment}{// If there is an input file, parse it to get the parameters. Else, parse the command line}
27     std::string input\_filename;
28     \textcolor{keywordflow}{if} (command\_line.search(2, \textcolor{stringliteral}{"--inputfile"}, \textcolor{stringliteral}{"-i"})) \{
29         input\_filename = command\_line.next(input\_filename);
30         field\_parser.parse\_input\_file(input\_filename, \textcolor{stringliteral}{"#"}, \textcolor{stringliteral}{"\(\backslash\)n"}, \textcolor{stringliteral}{" \(\backslash\)t\(\backslash\)n"});
31     \} \textcolor{keywordflow}{else} \{
32         field\_parser = command\_line;
33     \}
34 
35     \hyperlink{structcarl_1_1libmesh__solve__linear__system__input__params}{carl::libmesh\_solve\_linear\_system\_input\_params} 
      input\_params;
36     \hyperlink{namespacecarl_a902f88f3c52c6fc9c974bc99832e78a7}{carl::get\_input\_params}(field\_parser, input\_params);
37 
38     \textcolor{comment}{// Check libMesh installation dimension}
39     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} dim = 3;
40 
41     libmesh\_example\_requires(dim == LIBMESH\_DIM, \textcolor{stringliteral}{"3D support"});
42 
43     \textcolor{comment}{// --- Set the matrix and vectors}
44 
45     \textcolor{comment}{// Set up the PETSC versions}
46     Mat sys\_mat\_PETSC;
47     Vec sys\_rhs\_vec\_PETSC;
48 
49     MatCreate(WorldComm.get(),&sys\_mat\_PETSC);
50     VecCreate(WorldComm.get(),&sys\_rhs\_vec\_PETSC);
51     
52     \textcolor{comment}{// Read}
53     \hyperlink{namespacecarl_ac9086ba3b6072efdbafaaa5ae53927de}{carl::read\_PETSC\_matrix}(sys\_mat\_PETSC, input\_params.
      \hyperlink{structcarl_1_1libmesh__solve__linear__system__input__params_a2a39165021ba68bc91c857d860539c34}{sys\_matrix\_file}, WorldComm.get());
54     \hyperlink{namespacecarl_a4d0e2c60b0765dc8182c95362c5d329a}{carl::read\_PETSC\_vector}(sys\_rhs\_vec\_PETSC, input\_params.
      \hyperlink{structcarl_1_1libmesh__solve__linear__system__input__params_ab61ffd0ba104883487ed36c6b5ce9e70}{sys\_rhs\_vec\_file}, WorldComm.get());
55 
56     \textcolor{comment}{// Set up the libMesh versions}
57     libMesh::PetscMatrix<libMesh::Number> sys\_mat(sys\_mat\_PETSC,WorldComm);
58     libMesh::PetscVector<libMesh::Number> sys\_rhs\_vec(sys\_rhs\_vec\_PETSC,WorldComm);
59     libMesh::PetscVector<libMesh::Number> sys\_sol\_vec(WorldComm);
60     sys\_sol\_vec.init(sys\_rhs\_vec);
61 
62     PetscInt local\_N;
63     MatGetLocalSize(sys\_mat\_PETSC,NULL,&local\_N);
64 
65     \textcolor{comment}{// --- Linear solver}
66     libMesh::PetscLinearSolver<libMesh::Number> KSP\_solver(WorldComm);
67     KSP\_solver.init(\textcolor{stringliteral}{"sys"});
68 
69     \textcolor{comment}{// If the nullspace vectors were given, read them}
70     \textcolor{keywordflow}{if} ( input\_params.\hyperlink{structcarl_1_1libmesh__solve__linear__system__input__params_ae381749fcf14eec703f3b5c79febf398}{bUseRBVectors} )
71     \{
72         std::cout << \textcolor{stringliteral}{" > Using the "} << input\_params.\hyperlink{structcarl_1_1libmesh__solve__linear__system__input__params_abe24bbe9e6a211c17bbb0d2f58d4cd90}{nb\_of\_rb\_vectors} << \textcolor{stringliteral}{" RB modes
       vectors!"} << std::endl;
73         \hyperlink{namespacecarl_ab3dd1aab6c2bea1fcbb086eb6aff4d16}{carl::attach\_rigid\_body\_mode\_vectors}(sys\_mat,input\_params.
      \hyperlink{structcarl_1_1libmesh__solve__linear__system__input__params_ab1c0d1c19d1849c0b32e0a1d95d11bff}{path\_to\_rb\_vectors},input\_params.\hyperlink{structcarl_1_1libmesh__solve__linear__system__input__params_abe24bbe9e6a211c17bbb0d2f58d4cd90}{nb\_of\_rb\_vectors},dim);
74         std::cout << \textcolor{stringliteral}{" > Attached the RB modes vectors!"} << std::endl;
75     \}
76 
77     \textcolor{comment}{// Solve!}
78     KSP\_solver.solve(sys\_mat,sys\_sol\_vec,sys\_rhs\_vec,input\_params.\hyperlink{structcarl_1_1libmesh__solve__linear__system__input__params_aac011ff9dbbc01b0177480e9cdadb5b8}{sys\_eps},input\_params.
      \hyperlink{structcarl_1_1libmesh__solve__linear__system__input__params_afead959622d671c5b5ee1200c2e43dad}{sys\_iter\_div});
79 
80     KSP\_solver.print\_converged\_reason();
81 
82 \textcolor{comment}{// Print MatLab debugging output? Variable defined at "carl\_headers.h"}
83 \textcolor{preprocessor}{#ifdef PRINT\_MATLAB\_DEBUG}
84     sys\_sol\_vec.print\_matlab(input\_params.\hyperlink{structcarl_1_1libmesh__solve__linear__system__input__params_a8ef071dca667af6aeafc942ff15df7ad}{output\_base} + \textcolor{stringliteral}{"\_sys\_sol\_vec.m"});
85 \textcolor{preprocessor}{#endif}
86 
87     \textcolor{comment}{// Export the solution vector}
88     \hyperlink{namespacecarl_a1632084ec1f296b63559648cc9c2047f}{carl::write\_PETSC\_vector}(sys\_sol\_vec, input\_params.
      \hyperlink{structcarl_1_1libmesh__solve__linear__system__input__params_a8ef071dca667af6aeafc942ff15df7ad}{output\_base} + \textcolor{stringliteral}{"\_sys\_sol\_vec.petscvec"});
89 
90     \textcolor{comment}{// --- Cleanup!}
91     MatDestroy(&sys\_mat\_PETSC);
92     VecDestroy(&sys\_rhs\_vec\_PETSC);
93 
94     \textcolor{keywordflow}{return} 0;
95 \}
\end{DoxyCode}
