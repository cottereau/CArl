\hypertarget{_c_arl__mult__coupling_8cpp}{}\section{/\+Users/breubreubreu/\+Programming/\+C\+Arl/\+Cpp/src/execs/\+C\+Arl\+\_\+tools/\+C\+Arl\+\_\+mult\+\_\+coupling.cpp File Reference}
\label{_c_arl__mult__coupling_8cpp}\index{/\+Users/breubreubreu/\+Programming/\+C\+Arl/\+Cpp/src/execs/\+C\+Arl\+\_\+tools/\+C\+Arl\+\_\+mult\+\_\+coupling.\+cpp@{/\+Users/breubreubreu/\+Programming/\+C\+Arl/\+Cpp/src/execs/\+C\+Arl\+\_\+tools/\+C\+Arl\+\_\+mult\+\_\+coupling.\+cpp}}
{\ttfamily \#include \char`\"{}C\+Arl\+\_\+mult\+\_\+coupling.\+h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{_c_arl__mult__coupling_8cpp_a3c04138a5bfe5d72780bb7e82a18e627}{main} (int argc, char $\ast$$\ast$argv)
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{_c_arl__mult__coupling_8cpp_a3c04138a5bfe5d72780bb7e82a18e627}{}\index{C\+Arl\+\_\+mult\+\_\+coupling.\+cpp@{C\+Arl\+\_\+mult\+\_\+coupling.\+cpp}!main@{main}}
\index{main@{main}!C\+Arl\+\_\+mult\+\_\+coupling.\+cpp@{C\+Arl\+\_\+mult\+\_\+coupling.\+cpp}}
\subsubsection[{main(int argc, char $\ast$$\ast$argv)}]{\setlength{\rightskip}{0pt plus 5cm}int main (
\begin{DoxyParamCaption}
\item[{int}]{argc, }
\item[{char $\ast$$\ast$}]{argv}
\end{DoxyParamCaption}
)}\label{_c_arl__mult__coupling_8cpp_a3c04138a5bfe5d72780bb7e82a18e627}


Definition at line 3 of file C\+Arl\+\_\+mult\+\_\+coupling.\+cpp.


\begin{DoxyCode}
3                                 \{
4 
5     \textcolor{comment}{// --- Initialize libMesh}
6     libMesh::LibMeshInit init(argc, argv);
7 
8     \textcolor{comment}{// Do performance log?}
9     libMesh::PerfLog perf\_log(\textcolor{stringliteral}{"Main program"});
10 
11     \textcolor{comment}{// libMesh's C++ / MPI communicator wrapper}
12     libMesh::Parallel::Communicator& WorldComm = init.comm();
13 
14     \textcolor{comment}{// Number of processors and processor rank.}
15     \textcolor{keywordtype}{int} rank = WorldComm.rank();
16     \textcolor{keywordtype}{int} nodes = WorldComm.size();
17 
18     \textcolor{comment}{// --- Set up inputs}
19 
20     \textcolor{comment}{// Command line parser}
21     GetPot command\_line(argc, argv);
22 
23     \textcolor{comment}{// File parser}
24     GetPot field\_parser;
25 
26     \textcolor{comment}{// If there is an input file, parse it to get the parameters. Else, parse the command line}
27     std::string input\_filename;
28     \textcolor{keywordflow}{if} (command\_line.search(2, \textcolor{stringliteral}{"--inputfile"}, \textcolor{stringliteral}{"-i"})) \{
29         input\_filename = command\_line.next(input\_filename);
30         field\_parser.parse\_input\_file(input\_filename, \textcolor{stringliteral}{"#"}, \textcolor{stringliteral}{"\(\backslash\)n"}, \textcolor{stringliteral}{" \(\backslash\)t\(\backslash\)n"});
31     \} \textcolor{keywordflow}{else} \{
32         field\_parser = command\_line;
33     \}
34 
35     \hyperlink{structcarl_1_1carl__mult__coupling__input__params}{carl::carl\_mult\_coupling\_input\_params} input\_params;
36     \hyperlink{namespacecarl_a902f88f3c52c6fc9c974bc99832e78a7}{get\_input\_params}(field\_parser, input\_params);
37 
38     \textcolor{comment}{// Check libMesh installation dimension}
39     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} dim = 3;
40 
41     libmesh\_example\_requires(dim == LIBMESH\_DIM, \textcolor{stringliteral}{"3D support"});
42 
43     \textcolor{comment}{// --- Set the matrix and vectors}
44 
45     \textcolor{comment}{// Set up the PETSC versions}
46     Mat coupl\_mat\_PETSC;
47     Vec input\_vec\_PETSC;
48 
49     MatCreate(PETSC\_COMM\_WORLD,&coupl\_mat\_PETSC);
50     VecCreate(PETSC\_COMM\_WORLD,&input\_vec\_PETSC);
51     
52     \textcolor{comment}{// Read}
53     \hyperlink{namespacecarl_ac9086ba3b6072efdbafaaa5ae53927de}{carl::read\_PETSC\_matrix}(coupl\_mat\_PETSC, input\_params.
      \hyperlink{structcarl_1_1carl__mult__coupling__input__params_a3ad1c5068c4613c3e8b15d64125c4a04}{coupl\_matrix\_file}, WorldComm.get());
54     \hyperlink{namespacecarl_a4d0e2c60b0765dc8182c95362c5d329a}{carl::read\_PETSC\_vector}(input\_vec\_PETSC, input\_params.
      \hyperlink{structcarl_1_1carl__mult__coupling__input__params_ad87a4f40746d5fca6085a280adaaa3d0}{input\_vec\_file}, WorldComm.get());
55 
56     \textcolor{comment}{// Set up the libMesh versions}
57     libMesh::PetscMatrix<libMesh::Number> coupl\_mat(coupl\_mat\_PETSC,WorldComm);
58     libMesh::PetscVector<libMesh::Number> input\_vec(input\_vec\_PETSC,WorldComm);
59 
60     \textcolor{comment}{// Set the output vector}
61     PetscInt N, local\_N;
62     MatGetSize(coupl\_mat\_PETSC,&N,NULL);
63     MatGetLocalSize(coupl\_mat\_PETSC,&local\_N,NULL);
64 
65     libMesh::PetscVector<libMesh::Number> output\_vec(WorldComm,N,local\_N);
66 
67     \textcolor{comment}{// --- Multiply ...}
68     coupl\_mat.vector\_mult(output\_vec,input\_vec);
69     
70 \textcolor{comment}{// Print MatLab debugging output? Variable defined at "carl\_headers.h"}
71 \textcolor{preprocessor}{#ifdef PRINT\_MATLAB\_DEBUG}
72     output\_vec.print\_matlab(input\_params.\hyperlink{structcarl_1_1carl__mult__coupling__input__params_ae8b0746e5db705a3ece18ea951b8b9c4}{output\_base} + \textcolor{stringliteral}{"\_output\_vec.m"});
73 \textcolor{preprocessor}{#endif}
74 
75     \textcolor{comment}{// Export the solution vector}
76     \hyperlink{namespacecarl_a1632084ec1f296b63559648cc9c2047f}{carl::write\_PETSC\_vector}(output\_vec, input\_params.
      \hyperlink{structcarl_1_1carl__mult__coupling__input__params_ae8b0746e5db705a3ece18ea951b8b9c4}{output\_base} + \textcolor{stringliteral}{"\_output\_vec.petscvec"});
77 
78     \textcolor{comment}{// --- Cleanup!}
79     MatDestroy(&coupl\_mat\_PETSC);
80     VecDestroy(&input\_vec\_PETSC);
81 
82     \textcolor{keywordflow}{return} 0;
83 \}
\end{DoxyCode}
